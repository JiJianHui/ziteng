function daysBetween(a,b){var c=a.substring(5,a.lastIndexOf("-")),d=a.substring(a.length,a.lastIndexOf("-")+1),e=a.substring(0,a.indexOf("-")),f=b.substring(5,b.lastIndexOf("-")),g=b.substring(b.length,b.lastIndexOf("-")+1),h=b.substring(0,b.indexOf("-")),i=(Date.parse(c+"/"+d+"/"+e)-Date.parse(f+"/"+g+"/"+h))/864e5;return Math.abs(i)}function get_city_list(a){var b=panel=panels=tabs="";for(var c in a){var d=a[c];if(b+="<li>"+d.Name+"</li>","\u70ed\u95e8"!=d.Name){for(var c=0;c<d.Name.length;c++){var e=d.CityList,f=d.Name.substr(c,1).toLowerCase();panel+="<p><strong>"+f.toUpperCase()+"</strong></p><p>";for(var g in e){var h=e[g],i=h.CityNameEn.substr(0,1).toLowerCase();f==i&&(panel+='<a href="'+h.CityId+'" relid="'+h.CityId+'">'+h.CityNameCn+"</a>")}panel+="</p>"}panels+='<div class="panel-content">'+panel+'<div class="space_05"></div></div>',panel=""}else{var e=d.CityList;for(var g in e){var h=e[g];panel+='<a href="'+h.CityId+'" relid="'+h.CityId+'">'+h.CityNameCn+"</a>"}panels+='<div class="panel-content">'+panel+'<div class="space_05"></div></div>',panel=""}}return b='<ul class="citylist-nav">'+b+"</ul>",tabs='<div class="citylist-tab"><div class="close" style="float:right">\xd7</div><div class="neiBor">'+b+panels+"</div>"+"</div>",tabs=$(tabs),$(".citylist-tab .close").live("click",function(){$(".citylist-tab").hide()}),tabs}function LoadSearch(){$.getJSON("http://www.sunnychina.com/api/city.html",function(a){var b=get_city_list(a);$("#cityName").after(b),$("ul.citylist-nav li").eq(0).addClass("current"),$(".citylist-tab .neiBor div.panel-content").hide().eq(0).show(),$("ul.citylist-nav li").click(function(){$("ul.citylist-nav li").removeClass("current"),$(this).addClass("current"),$("ul.citylist-nav li").each(function(a){$(this).hasClass("current")&&$(".citylist-tab .neiBor div.panel-content").hide().eq(a).show()})})});var a=par.cityId||$.cookie("cityId");a=a||"0101";var b=par.cityName||$.cookie("cityname");if(b=b||"\u5317\u4eac",$("#cityName").val(b),$("#cityName").attr("cityId",a),par.cityId=a,(""==$("#cityName").val()||null==$("#cityName").val())&&$("#cityName").val(b),$.cookie("checkInTime")){if(new Date($.cookie("checkInTime").replace(/-/g,"/"))<new Date){var c=new Date;c.setDate(Number(c.getDate()+1)),$.cookie("checkInTime",c.Format("yyyy-MM-dd"),{path:"/",domain:".sunnychina.com"}),c.setDate(Number(c.getDate()+1)),$.cookie("checkOutTime",c.Format("yyyy-MM-dd"),{path:"/",domain:".sunnychina.com"})}}else{var c=new Date;c.setDate(Number(c.getDate()+1)),$.cookie("checkInTime",c.Format("yyyy-MM-dd"),{path:"/",domain:".sunnychina.com"}),c.setDate(Number(c.getDate()+1)),$.cookie("checkOutTime",c.Format("yyyy-MM-dd"),{path:"/",domain:".sunnychina.com"})}$("#CheckOutDate").val($.cookie("checkOutTime")||"").datepicker({numberOfMonths:2,minDate:$.cookie("checkInTime"),dateFormat:"yy-mm-dd",onSelect:function(a){$.cookie("checkOutTime",a,{path:"/",domain:".sunnychina.com"});var b=a.split("-");b=new Date(Date.parse(b[0]+"/"+b[1]+"/"+b[2])),$("span.right_text",$("#CheckOutDate").parent()).html(b.FormatWeek("w")),$("#ui-datepicker-div").hide()}}),$("#CheckInDate").val($.cookie("checkInTime")||"").datepicker({numberOfMonths:2,minDate:0,maxDate:"+90D",dateFormat:"yy-mm-dd",onSelect:function(a){var b=$(this).data("datepicker"),c=$.datepicker.parseDate(b.settings.dateFormat||$.datepicker._defaults.dateFormat,a,b.settings),d=new Date(Date.parse(c)+864e5);$("#CheckOutDate").datepicker("option","minDate",d),$.cookie("checkInTime",a,{path:"/",domain:".sunnychina.com"});var e=a.split("-");e=new Date(Date.parse(e[0]+"/"+e[1]+"/"+e[2])),$("span.right_text",$("#CheckInDate").parent()).html(e.FormatWeek("w"))},onClose:function(){$("#CheckOutDate").datepicker("show")}}),$("span.right_text:first").click(function(){$("#CheckInDate").datepicker("show")}),$("span.right_text:last").click(function(){$("#CheckOutDate").datepicker("show")}),$("#cityName").click(function(){$(this).select().next().show().find("a").click(function(){return a=$(this).attr("relid"),b=$(this).text(),""!=b&&$("#cityName").val(b),$("#cityName").attr("cityId",a),$.cookie("cityId",a,{path:"/",domain:".sunnychina.com"}),par.cityId=a,$.cookie("cityname",b,{path:"/",domain:".sunnychina.com"}),$(this).parent().parent().parent().hide(),!1})}).autocomplete({minLength:0,source:function(a,b){$.getJSON("http://www.sunnychina.com/api/city.html?key="+encodeURIComponent(a.term),function(a){b($.map(a,function(a){return{label:a.CityNameCn+"("+a.CityNameEn+")",value:a.CityNameCn,id:a.CityId,name:a.CityNameCn}}))})},select:function(c,d){a=d.item.id,$("#cityName").val(d.item.value),$("#cityName").attr("cityId",a),par.cityId=a,b=d.item.name,$.cookie("cityId",a,{path:"/",domain:".sunnychina.com"}),$.cookie("cityname",b,{path:"/",domain:".sunnychina.com"})},open:function(){$(".citylist-tab").hide()},search:function(){}}),$("#cityName").bind("input.autocomplete",function(){$(this).trigger("keydown.autocomplete")}),""==par.keyPoiName?$("#KeyPoiName").val("\u5982:\u706b\u8f66\u7ad9"):$("#KeyPoiName").val(par.keyPoiName),$("#KeyPoiName").click(function(){"\u5982:\u706b\u8f66\u7ad9"==$(this).val()&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val("\u5982:\u706b\u8f66\u7ad9")}),""==par.hotelName?$("#HotelName").val("\u8f93\u5165\u9152\u5e97\u540d"):$("#HotelName").val(par.hotelName),$("#HotelName").click(function(){"\u8f93\u5165\u9152\u5e97\u540d"==$(this).val()&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val("\u8f93\u5165\u9152\u5e97\u540d")}),$("#btnSearch").click(SubmitForm)}function MM_preloadImages(){var a=document;if(a.images){a.MM_p||(a.MM_p=new Array);var b,c=a.MM_p.length,d=MM_preloadImages.arguments;for(b=0;b<d.length;b++)0!=d[b].indexOf("#")&&(a.MM_p[c]=new Image,a.MM_p[c++].src=d[b])}}function formatListUrl(a,b){var c=a;if("0,20"==b)c=a.split("?")[0];else{var d=a.split("_"),e=b.split("||");for(n in e)d[parseInt(e[n].split(",")[1])]=e[n].split(",")[0],11==parseInt(e[n].split(",")[1])&&(d[parseInt(e[n].split(",")[1])]=e[n].split(",")[0]+"."+a.split(".")[1]);c="";for(n in d)c+=n<d.length-1?d[n]+"_":d[n]}return c}function getListUrl(){var a="/list_"+par.CityId+"_"+par.AreaId+"_"+par.AreaIdXz+"_"+par.PoiId+"_"+par.ChainId+"_"+par.MinPrice+"_"+par.MaxPrice+"_"+par.Sort+"_0_0_"+par.Page+".html";return(par.Position||par.KeyWords)&&(a+="?",par.Position&&(a+="&hpid="+encodeURI(par.Position)),par.KeyWords&&(a+="&keyw="+encodeURI(par.KeyWords))),a}function rmtips(){try{timeOut&&(window.clearTimeout(timeOut),timeOut=null),mdiv&&document.body.removeChild(mdiv)}catch(a){}}function ycrmtips(){window.clearTimeout(timeOut),timeOut=window.setTimeout("rmtips()",100)}function _xy(a){for(var b=0,c=0;null!=a;b+=a.offsetTop,c+=a.offsetLeft,a=a.offsetParent);return new Array(c,b)}function views(a,b,c){window.clearTimeout(timeOut);var d="",e=300;"v0"==b&&(e=320,d=c),"v1"==b&&(e=400,d=c),"v3"==b&&(d='\u7f51\u4e0a\u6210\u529f\u8ba2\u8d2d\u6b64\u623f\u578b\uff0c\u6bcf\u95f4\u591c\u53ef\u83b7\u5f97<span class="jiangjin_red">'+c+"</span>\u5143\u73b0\u91d1\u8fd4\u8fd8\uff081\u95f4\u623f\u4f4f1\u665a\u79f0\u4e3a1\u4e2a\u95f4\u591c\uff0c\u59822\u95f4\u623f\u4f4f1\u665a\u62161\u95f4\u623f\u4f4f2\u665a\uff0c\u5219\u4e3a2\u95f4\u591c\uff09\uff0c\u5b9e\u9645\u5165\u4f4f\u3001\u79bb\u5e97\u540e5\u4e2a\u5de5\u4f5c\u65e5\u5185\uff0c\u5956\u91d1\u8fd4\u8fd8\u5230\u60a8\u5728\u9633\u5149\u7684\u201c\u73b0\u91d1\u8d26\u6237\u201d\u4e2d\uff0c\u53ef\u968f\u65f6\u7533\u8bf7\u63d0\u53d6\u5230\u60a8\u6307\u5b9a\u94f6\u884c\u5361\u4e2d\u3002");var f='		<div class="com_arrow1" id="com_arrow"></div>		<div class="com_way"  id="com_way" style="width: '+e+'px;">			<div class="com_way_son">'+d+"</div>		</div>		";mdiv.innerHTML=f,document.body.appendChild(mdiv);var g=_xy(a),h=g[0]+a.offsetWidth/2-7.5,i=g[1]+a.offsetHeight+6,j=i+5,k=document.body.offsetWidth<h+e/2?document.body.offsetWidth-e-10:h-e/2+18.5;10>k&&(k=10);var l=document.body.scrollTop||document.documentElement.scrollTop,m=document.documentElement.clientHeight||document.body.clientHeight;j+$("#com_way").offsetHeight>l+m&&(i=g[1]-6-5,j=i-$("#com_way").offsetHeight+4,$("#com_arrow").className="com_arrow2"),$("#com_arrow").css("top",i+"px"),$("#com_arrow").css("left",h+"px"),$("#com_way").css("top",j+"px"),$("#com_way").css("left",k+"px"),$("#com_way").onmouseover=function(){window.clearTimeout(timeOut)},$("#com_way").onmouseout=ycrmtips,a.onmouseout=ycrmtips}function bookHotel(a,b,c){var d=$.cookie("checkInTime").replace("-","").replace("-",""),e=$.cookie("checkOutTime").replace("-","").replace("-",""),f="/book_"+c+"_"+b+"_"+a+".html?indate="+d+"&outdate="+e;window.top.location=f}function left(a,b){return b>0?a.substring(0,b):null}function right(a,b){return a.length-b>=0&&a.length>=0&&a.length-b<=a.length?a.substring(a.length-b,a.length):null}function mid(a,b,c){return a.length>=0?a.substr(b,c):null}function GetJsonHotelUrl(){var a=arguments[0]?arguments[0]:0;return GetHotelUrl=a?"/hotel/list_"+par.cityId+"_0_0_0_0_0_0_0_0_"+par.sort+"_0_0_"+par.baiduLat+"_"+par.baiduLng+"_0_1.html?checkInDate="+par.checkInDate+"&checkOutDate="+par.checkOutDate:"/hotel/list_"+par.cityId+"_"+par.areaId+"_"+par.areaIdXz+"_"+par.chainId+"_"+par.poiId+"_"+par.minPrice+"_"+par.maxPrice+"_"+par.priceType+"_"+par.star+"_"+par.sort+"_"+par.isBulk+"_"+par.isPrepay+"_"+par.baiduLat+"_"+par.baiduLng+"_"+par.isSingle+"_"+par.page+".html?checkInDate="+par.checkInDate+"&checkOutDate="+par.checkOutDate,""!=par.hotelName&&(GetHotelUrl+="&hotelName="+encodeURIComponent(par.hotelName)),""!=par.keyPoiName&&(GetHotelUrl+="&keyPoiName="+encodeURIComponent(par.keyPoiName)),GetHotelUrl}function DateForJson(a){if(a.indexOf("-")<=0)return a;var b=a.split("-");return 1==b[1].length&&(b[1]="0"+String(b[1])),1==b[2].length&&(b[2]="0"+String(b[2])),String(b[0])+String(b[1])+String(b[2])}function showhelp(){$("#my_account ul.select_ul").removeClass("hidden"),$("#my_account span").addClass("name")}function hidehelp(){$("#my_account ul.select_ul").addClass("hidden"),$("#my_account span").removeClass("name")}jQuery.cookie=function(a,b,c){if(arguments.length>1&&(null===b||"object"!=typeof b)){if(c=jQuery.extend({},c),null===b&&(c.expires=-1),"number"==typeof c.expires){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}return document.cookie=[encodeURIComponent(a),"=",c.raw?String(b):encodeURIComponent(String(b)),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};var f,g=c.raw?function(a){return a}:decodeURIComponent;return(f=new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?g(f[1]):null},jQuery(function(a){a.datepicker.regional["zh-CN"]={closeText:"\u5173\u95ed",prevText:"&#x3c;\u4e0a\u6708",nextText:"\u4e0b\u6708&#x3e;",currentText:"\u4eca\u5929",monthNames:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],monthNamesShort:["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"],dayNames:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],dayNamesShort:["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],dayNamesMin:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],weekHeader:"\u5468",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"\u5e74"},a.datepicker.setDefaults(a.datepicker.regional["zh-CN"])}),Date.prototype.Format=function(a){var b=a,c=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"];return b=b.replace(/yyyy|YYYY/,this.getFullYear()),b=b.replace(/yy|YY/,this.getYear()%100>9?(this.getYear()%100).toString():"0"+this.getYear()%100),b=b.replace(/MM/,this.getMonth()+1>9?(this.getMonth()+1).toString():"0"+(this.getMonth()+1)),b=b.replace(/M/g,this.getMonth()+1),b=b.replace(/w|W/g,c[this.getDay()]),b=b.replace(/dd|DD/,this.getDate()>9?this.getDate().toString():"0"+this.getDate()),b=b.replace(/d|D/g,this.getDate()),b=b.replace(/hh|HH/,this.getHours()>9?this.getHours().toString():"0"+this.getHours()),b=b.replace(/h|H/g,this.getHours()),b=b.replace(/mm/,this.getMinutes()>9?this.getMinutes().toString():"0"+this.getMinutes()),b=b.replace(/m/g,this.getMinutes()),b=b.replace(/ss|SS/,this.getSeconds()>9?this.getSeconds().toString():"0"+this.getSeconds()),b=b.replace(/s|S/g,this.getSeconds())},Date.prototype.FormatWeek=function(a){var b=a,c=["\u661f\u671f\u5929","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],d=new Date,e=daysBetween(this.Format("YYYY-MM-DD"),d.Format("YYYY-MM-DD"));if(!(3>e&&e>=0))return b=b.replace(/w|W/g,c[this.getDay()]);switch(e){case 0:return"\u4eca\u5929";case 1:return"\u660e\u5929";case 2:return"\u540e\u5929";default:return"\u4eca\u5929"}};var mdiv=document.createElement("div"),timeOut=null;$(document).ready(function(){$("#my_account span.hax").mouseover(function(){showhelp()}),$("#my_account ul.select_ul").mouseover(function(){showhelp()}),$("#my_account ul.select_ul,#my_account span.hax").mouseout(function(){hidehelp()})});